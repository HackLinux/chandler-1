<?xml version="1.0"?>

<agent name="Presence Approval Agent">
   <attribute name="roles">approval</attribute>
   <attribute name="agentDescription">This agent automatically approves presence subscription requests when the sender
   meets various criterion.
    </attribute>

   <repertoire name="Test Agent Repertoire">
   </repertoire>
   
   <instruction enabled="True">
       <condition name="Presence Subscription Request">
         <attribute name="conditionDescription">match the presence subscription request with a pre-approved list</attribute>
         <attribute name="conditionNotification">chandler/im/presence-request</attribute>
         <attribute name="conditionFilterMode">matches</attribute>
         <attribute name="conditionAttribute">who</attribute>
         <attribute name="conditionValue">.*osafoundation.*</attribute>     
      </condition>

       <action name="Approve Subscription Request">
         <attribute name="actionType">inline</attribute>
         <attribute name="actionDescription">this action approves a subscription request</attribute>
         <attribute name="actionScript">agent.agentManager.application.jabberClient.AcceptSubscriptionRequest(data['who']); agent.agentManager.SetHandledStatus(notification, True)</attribute>
      </action>    
   </instruction> 
</agent>
