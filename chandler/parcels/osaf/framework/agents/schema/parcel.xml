<?xml version="1.0" encoding="iso-8859-1"?>

<!-- Here are schema definitions for the AgentItem repository object as well as related subjects -->
<!-- Schemas for: Condition, Action, Instruction, Repertoire, AgentItem -->

<!-- $Revision$ -->
<!-- $Date$ -->
<!-- Copyright (c) 2003 Open Source Applications Foundation -->
<!-- License: http://osafoundation.org/Chandler_0.1_license_terms.htm -->

<Parcel describes="//parcels/osaf/framework/agents/schema"
        itsName="schema"
        xmlns="http://osafoundation.org/parcels/core"
        xmlns:agents="http://osafoundation.org/parcels/osaf/framework/agents/schema"
        xmlns:blah="http://osafoundation.org/parcels/osaf/framework/utils"
        xmlns:indexes="http://osafoundation.org/parcels/osaf/framework/utils/indexer">

  <displayName>Agent Schema</displayName>
  <description>Agent schema for the 0.2 release</description>
  <version>0.2</version>

  <!-- Kind: Action -->

  <Kind itsName="Action">
    <displayName>Action</displayName>

    <Enumeration itsName="ActionTypeEnum">
      <values>none</values>
      <values>script</values>
      <values>expression</values>
      <values>inline</values>
      <values>classmethod</values>
    </Enumeration>

    <Attribute itsName="actionType">
      <displayName>Action Type</displayName>
      <type itemref="agents:Action/ActionTypeEnum"/>
      <cardinality>single</cardinality>
      <!-- <defaultValue>none</defaultValue> -->
    </Attribute>
  
    <Attribute itsName="actionScript">
      <displayName>Action Script</displayName>
      <type itemref="String"/>
      <cardinality>single</cardinality>
    </Attribute>
  
    <Attribute itsName="actionValue">
      <displayName>Action Script</displayName>
      <type itemref="String"/>
      <cardinality>single</cardinality>
    </Attribute>

    <Attribute itsName="actionFilePath">
      <displayName>Action Script</displayName>
      <type itemref="String"/>
      <cardinality>single</cardinality>
    </Attribute>

    <Attribute itsName="asyncFlag">
      <displayName>Asynchronous Flag</displayName>
      <type itemref="Boolean"/>
      <cardinality>single</cardinality>
      <defaultValue type="Boolean">False</defaultValue>
    </Attribute>

    <Attribute itsName="wxThreadFlag">
      <displayName>Asynchronous Flag</displayName>
      <type itemref="Boolean"/>
      <cardinality>single</cardinality>
      <defaultValue type="Boolean">False</defaultValue>
    </Attribute>
    
    <Attribute itsName="confirmFlag">
      <displayName>Request Confirmation Flag</displayName>
      <type itemref="Boolean"/>
      <cardinality>single</cardinality>
      <defaultValue type="Boolean">False</defaultValue>
    </Attribute>

    <Attribute itsName="actionPermissionRequest">
      <displayName>Action Script</displayName>
      <type itemref="String"/>
      <cardinality>single</cardinality>
    </Attribute>

    <Attribute itsName="actionOwner">
      <displayName>Action Instruction Backlink</displayName>
      <type itemref="agents:Instruction"/>
      <cardinality>list</cardinality>
      <inverseAttribute itemref="agents:Instruction/actions"/>
    </Attribute>
  
    <Attribute itsName="actionRepertoireOwner">
      <displayName>Action Repertoire Backlink</displayName>
      <type itemref="agents:Repertoire"/>
      <cardinality>single</cardinality>
      <inverseAttribute itemref="agents:Repertoire/possibleActions"/>
    </Attribute>

    <attributes itemref="agents:Action/actionType"/>
    <attributes itemref="agents:Action/actionScript"/>
    <attributes itemref="agents:Action/actionValue"/>
    <attributes itemref="agents:Action/actionFilePath"/>     
    <attributes itemref="agents:Action/actionPermissionRequest"/>     
    <attributes itemref="agents:Action/asyncFlag"/>
    <attributes itemref="agents:Action/wxThreadFlag"/>
    <attributes itemref="agents:Action/confirmFlag"/>
    <attributes itemref="agents:Action/actionOwner"/>
    <attributes itemref="agents:Action/actionRepertoireOwner"/>
    <superKinds itemref="Item"/>
    <classes key="python">osaf.framework.agents.schema.Action.Action</classes>
  </Kind>

  <Kind itsName="DialogAction">
    <displayName>Dialog Action</displayName>
    <superKinds itemref="agents:Action"/>
    <classes key="python">osaf.framework.agents.schema.DialogAction.DialogAction</classes>
  </Kind>


  <!-- Kind: Condition -->
  
  <Kind itsName="Condition">
    <displayName>Condition</displayName>

    <!-- what is this really used for? -->
    <Enumeration itsName="ConditionTypeEnum">
      <values>none</values>
      <values>notification</values>
      <values>timed</values>
    </Enumeration>

    <Attribute itsName="conditionType">
      <displayName>Condition Type</displayName>
      <type itemref="agents:Condition/ConditionTypeEnum"/>
      <cardinality>single</cardinality>
      <!-- <defaultValue>none</defaultValue> -->
    </Attribute>

    <Enumeration itsName="ConditionFilterModeEnum">
      <values>none</values>
      <values>listequals</values>
      <values>equals</values>
      <values>notequals</values>
      <values>contains</values>
      <values>matches</values>
    </Enumeration>

    <Attribute itsName="conditionFilterMode">
      <displayName>Filter comparison mode</displayName>
      <type itemref="agents:Condition/ConditionFilterModeEnum"/>
      <cardinality>single</cardinality>
      <!-- <defaultValue>none</defaultValue> -->
    </Attribute>

    <Attribute itsName="conditionValue">
      <displayName>Value for filtering</displayName>
      <type itemref="String"/>
      <cardinality>single</cardinality>
    </Attribute>
  
    <Attribute itsName="conditionAttribute">
      <displayName>Attribute of data to compare with</displayName>
      <type itemref="String"/>
      <cardinality>single</cardinality>
    </Attribute>
  
    <Attribute itsName="conditionNotification">
      <displayName>Condition Notification</displayName>
      <type itemref="Item"/>
      <cardinality>single</cardinality>
    </Attribute>
  
    <Attribute itsName="conditionOwner">
      <displayName>Condition Owner</displayName>
      <type itemref="agents:Instruction"/>
      <cardinality>single</cardinality>
      <inverseAttribute itemref="agents:Instruction/condition"/>
    </Attribute>

    <Attribute itsName="conditionRepertoireOwner">
      <displayName>Action Repertoire Backlink</displayName>
      <type itemref="agents:Repertoire"/>
      <cardinality>single</cardinality>
      <inverseAttribute itemref="agents:Repertoire/possibleConditions"/>
    </Attribute>

    <attributes itemref="agents:Condition/conditionType"/>
    <attributes itemref="agents:Condition/conditionFilterMode"/>
    <attributes itemref="agents:Condition/conditionValue"/>
    <attributes itemref="agents:Condition/conditionAttribute"/>    
    <attributes itemref="agents:Condition/conditionNotification"/>
    <attributes itemref="agents:Condition/conditionOwner"/>
    <attributes itemref="agents:Condition/conditionRepertoireOwner"/>
    <superKinds itemref="Item"/>
    <classes key="python">osaf.framework.agents.schema.Condition.Condition</classes>
  </Kind>


  <!-- Kind: Schedule -->

  <Kind itsName="Schedule">
    <displayName>Timed Condition</displayName>

    <Attribute itsName="startTime">
      <displayName>Start Time</displayName>
      <type itemref="DateTime"/>
      <cardinality>single</cardinality>
    </Attribute>

    <Attribute itsName="repeatFlag">
      <displayName>Repeat Flag</displayName>
      <type itemref="Boolean"/>
      <cardinality>single</cardinality>
    </Attribute>

    <Attribute itsName="repeatDelay">
      <displayName>Repeat Delay</displayName>
      <type itemref="DateTimeDelta"/>
      <cardinality>single</cardinality>
    </Attribute>

    <Attribute itsName="scheduleOwner">
      <displayName>Schedule Owner</displayName>
      <type itemref="agents:Instruction"/>
      <cardinality>single</cardinality>
      <inverseAttribute itemref="agents:Instruction/schedule"/>
    </Attribute>

    <attributes itemref="agents:Schedule/startTime"/>
    <attributes itemref="agents:Schedule/repeatFlag"/>
    <attributes itemref="agents:Schedule/repeatDelay"/>
    <attributes itemref="agents:Schedule/scheduleOwner"/>
    <superKinds itemref="Item"/>
  </Kind>


  <!-- Kind: Instruction -->

  <Kind itsName="Instruction">
    <displayName>Instruction</displayName>

    <Attribute itsName="enabled">
      <displayName>Enabled Flag</displayName>
      <type itemref="Boolean"/>
      <cardinality>single</cardinality>
      <defaultValue type="Boolean">False</defaultValue>
    </Attribute>

    <Attribute itsName="schedule">
      <displayName>Instruction Schedule</displayName>
      <type itemref="agents:Schedule"/>
      <cardinality>single</cardinality>
      <inverseAttribute itemref="agents:Schedule/scheduleOwner"/>
    </Attribute>
  
    <Attribute itsName="condition">
      <displayName>Instruction Condition</displayName>
      <type itemref="agents:Condition"/>
      <cardinality>single</cardinality>
      <inverseAttribute itemref="agents:Condition/conditionOwner"/>
    </Attribute>
  
    <Attribute itsName="actions">
      <displayName>Instruction Actions</displayName>
      <type itemref="agents:Action"/>
      <cardinality>list</cardinality>
      <inverseAttribute itemref="agents:Action/actionOwner"/>
    </Attribute>
  
    <Attribute itsName="instructionOwner">
      <displayName>Owning Agent</displayName>
      <type itemref="agents:AgentItem"/>
      <cardinality>single</cardinality>
      <inverseAttribute itemref="agents:AgentItem/instructions"/>
    </Attribute>

    <Attribute itsName="timers">
      <displayName>Timers</displayName>
      <type itemref="UUID"/>
      <cardinality>dict</cardinality>
    </Attribute>  

    <attributes itemref="agents:Instruction/enabled"/>
    <attributes itemref="agents:Instruction/schedule"/>
    <attributes itemref="agents:Instruction/condition"/>
    <attributes itemref="agents:Instruction/actions"/>
    <attributes itemref="agents:Instruction/instructionOwner"/>
    <attributes itemref="agents:Instruction/timers"/>
    <superKinds itemref="Item"/>
    <classes key="python">osaf.framework.agents.schema.Instruction.Instruction</classes>
  </Kind>
  
  
  <!-- Kind: Repertoire -->

  <Kind itsName="Repertoire">
    <displayName>Repertoire</displayName>

    <Attribute itsName="possibleActions">
      <displayName>Possible Actions</displayName>
      <type itemref="agents:Action"/>
      <cardinality>list</cardinality>
      <inverseAttribute itemref="agents:Action/actionRepertoireOwner"/>
    </Attribute>

    <Attribute itsName="possibleConditions">
      <displayName>Possible Conditions</displayName>
      <type itemref="agents:Condition"/>
      <cardinality>list</cardinality>
      <inverseAttribute itemref="agents:Condition/conditionRepertoireOwner"/>
    </Attribute>
  
    <Attribute itsName="repertoireOwner">
      <displayName>Owning Agent</displayName>
      <type itemref="agents:AgentItem"/>
      <cardinality>single</cardinality>
      <inverseAttribute itemref="agents:AgentItem/repertoire"/>
    </Attribute>

    <attributes itemref="agents:Repertoire/possibleActions"/>
    <attributes itemref="agents:Repertoire/possibleConditions"/>
    <attributes itemref="agents:Repertoire/repertoireOwner"/>
    <classes key="python">osaf.framework.agents.schema.Repertoire.Repertoire</classes>
    <superKinds itemref="Item"/>
  </Kind>

  
  <!-- Kind: AgentItem -->

  <Kind itsName="AgentItem">
    <displayName>The Agent</displayName>

    <Attribute itsName="roles">
      <displayName>Agent Roles</displayName>
      <type itemref="String"/>
      <cardinality>list</cardinality>
    </Attribute>

    <Attribute itsName="repertoire">
      <displayName>Agent Repertoire</displayName>
      <type itemref="agents:Repertoire"/>
      <cardinality>single</cardinality>
      <inverseAttribute itemref="agents:Repertoire/repertoireOwner"/>
    </Attribute>

    <Attribute itsName="instructions">
      <displayName>Agent Instructions</displayName>
      <type itemref="agents:Instruction"/>
      <cardinality>list</cardinality>
      <inverseAttribute itemref="agents:Instruction/instructionOwner"/>
    </Attribute>

    <Attribute itsName="sourceFile">
      <displayName>Path of Source File</displayName>
      <type itemref="String"/>
      <cardinality>single</cardinality>
    </Attribute>

    <Attribute itsName="status">
      <displayName>Status Dictionary</displayName>
      <type itemref="String"/>
      <cardinality>dict</cardinality>
    </Attribute>

    <Attribute itsName="imageData">
      <displayName>Image Data</displayName>
      <type itemref="String"/>
      <cardinality>dict</cardinality>
    </Attribute>

    <Attribute itsName="prefData">
      <displayName>Preference Data</displayName>
      <type itemref="String"/>
      <cardinality>dict</cardinality>
    </Attribute>

    <attributes itemref="indexes:indexedBy"/>
    <attributes itemref="agents:AgentItem/roles"/>
    <attributes itemref="agents:AgentItem/repertoire"/>
    <attributes itemref="agents:AgentItem/instructions"/>
    <attributes itemref="agents:AgentItem/sourceFile"/>
    <attributes itemref="agents:AgentItem/imageData"/>
    <attributes itemref="agents:AgentItem/prefData"/>
    <attributes itemref="agents:AgentItem/status"/>
    <superKinds itemref="Item"/>
    <classes key="python">osaf.framework.agents.schema.AgentItem.AgentItem</classes>
  </Kind>

</Parcel>
