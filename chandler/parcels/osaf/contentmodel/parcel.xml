<?xml version="1.0" encoding="iso-8859-1"?>

<!-- Parcel manifest for Pim Schema -->
<!-- $Revision$ -->
<!-- $Date$ -->
<!-- Copyright (c) 2003-2004 Open Source Applications Foundation -->
<!-- License: http://osafoundation.org/Chandler_0.1_license_terms.htm -->

<Parcel itsName="contentmodel"
    itemClass="osaf.contentmodel.ContentModel.ContentModel"
    xmlns="http://osafoundation.org/parcels/core"
    xmlns:contact="http://osafoundation.org/parcels/osaf/contentmodel/contacts"
    xmlns:calendar="http://osafoundation.org/parcels/osaf/contentmodel/calendar"
    xmlns:tasks="http://osafoundation.org/parcels/osaf/contentmodel/tasks"
    xmlns:mail="http://osafoundation.org/parcels/osaf/contentmodel/mail"
    xmlns:blocks="http://osafoundation.org/parcels/osaf/framework/blocks"
    xmlns:cm="http://osafoundation.org/parcels/osaf/contentmodel"
    xmlns:share="http://osafoundation.org/parcels/osaf/framework/sharing"
    >

    <displayName>Chandler Content Model</displayName>
    <description>Content Model for the 0.5 release</description>
    <version>0.5</version>
    <author>Open Source Applications Foundation</author>

    <Kind itsName="ContentKind">
        <displayName value="Metakind 'Content Kind'"/>
        <description>
    This kind is a metakind for creating other kinds.  Kinds which are
    an instance of ContentKind will have an attribute 'detailView' of type
    Block.  We could also make this attribute a bidiref.
        </description>
        <superKinds itemref="Kind"/>
        <Attribute itsName="detailView">
            <type itemref="blocks:Block"/>
        </Attribute>
    </Kind>



    <!-- Content Item -->

    <Kind itsName="ContentItem">
        <superKinds itemref="Item"/>
        <classes key="python">osaf.contentmodel.ContentModel.ContentItem</classes>
        <displayName>Content Item</displayName>
        <examples>an Calendar Event -- 'Lunch with Tug'</examples>
        <examples>a Contact -- 'Terry Smith'</examples>
        <examples>a Task -- 'mail 1040 to IRS'</examples>
        <description>Content Item is the abstract super-kind for things like Contacts, Calendar Events, Tasks, Mail Messages, and Notes. Content Items are user-level items, which a user might file, categorize, share, and delete.</description>

        <Attribute itsName="importance">
            <displayName>Importance</displayName>
            <description>Most items are of normal importance (no value need be show), however some things may be flagged either highly important or merely 'fyi'. This attribute is also used in the mail schema, so we shouldn't make any changes here that would break e-mail interoperability features.</description>

            <Enumeration itsName="ImportanceEnum">
                <displayName>Importance Enum</displayName>
                <values>important</values>
                <values>normal</values>
                <values>fyi</values>
            </Enumeration>

            <type itemref="cm:ContentItem/importance/ImportanceEnum"/>
            <initialValue type="cm:ContentItem/importance/ImportanceEnum">normal</initialValue>

        </Attribute>

        <Attribute itsName="contentsOwner">
            <type itemref="blocks:Block"/>
            <cardinality>list</cardinality>
            <inverseAttribute itemref="blocks:Block/contents"/>
        </Attribute>

        <attributes itemref="blocks:Block/viewContainer"/>

        <attributes itemref="blocks:Block/TPBDetailItemOwner"/>

        <attributes itemref="blocks:Block/TPBSelectedItemOwner"/>

        <!-- Sharing Cloud -->
        <Cloud itsName="SharingCloud">
          <Endpoint itsName="displayName">
            <attribute value="displayName"/>
          </Endpoint>
          <endpoints alias="displayName" itemref="cm:ContentItem/SharingCloud/displayName"/>
          <Endpoint itsName="body">
            <attribute value="body"/>
          </Endpoint>
          <endpoints itemref="cm:ContentItem/SharingCloud/body"/>
          <Endpoint itsName="issues">
            <attribute value="issues"/>
          </Endpoint>
          <endpoints itemref="cm:ContentItem/SharingCloud/issues"/>
          <!--
          <Endpoint itsName="body">
            <attribute value="body"/>
          </Endpoint>
          <endpoints itemref="cm:ContentItem/SharingCloud/body"/>
          -->
          <Endpoint itsName="createdOn">
            <attribute value="createdOn"/>
          </Endpoint>
          <endpoints itemref="cm:ContentItem/SharingCloud/createdOn"/>
        </Cloud>
        <clouds alias="sharing" itemref="cm:ContentItem/SharingCloud"/>

  </Kind>

  <!-- Note -->

  <Kind itsName="Note">
    <displayName>Note</displayName>
    <superKinds itemref="cm:ContentItem"/>
    <classes key="python">osaf.contentmodel.Notes.Note</classes>

    <!-- temporarily make this a real attribute instead of a redirection,
         because we want don't want to redirect this anywhere -->
    <Attribute itsName="who">
        <cardinality value="single"/>
        <type itemref="String"/>
        <initialValue value=""/>
    </Attribute>

    <!-- redirections -->
    <Attribute itsName="about">
      <redirectTo>displayName</redirectTo>
    </Attribute>

    <Attribute itsName="date">
      <redirectTo>createdOn</redirectTo>
    </Attribute>
  </Kind>


<!-- Stamped Kinds -->

  <Kind itsName="MailedTask">
    <displayName>Mailed Task</displayName>
    <description>A Task stamped as a Mail, or vica versa</description>
    <superKinds itemref="tasks:TaskMixin"/>
    <superKinds itemref="mail:MailMessage"/>
  </Kind>

  <Kind itsName="MailedEvent">
    <displayName>Mailed Event</displayName>
    <description>An Event stamped as a Mail, or vica versa</description>
    <superKinds itemref="calendar:CalendarEventMixin"/>
    <superKinds itemref="mail:MailMessage"/>
  </Kind>

  <Kind itsName="EventTask">
    <displayName>Event Task</displayName>
    <description>A Task stamped as an Event, or vica versa</description>
    <superKinds itemref="tasks:TaskMixin"/>
    <superKinds itemref="tasks:TaskEventExtraMixin"/>
    <superKinds itemref="calendar:CalendarEvent"/>
  </Kind>

  <Kind itsName="MailedEventTask">
    <displayName>Mailed Event Task</displayName>
    <description>A Task stamped as an Event stamped as Mail, in any sequence</description>
    <superKinds itemref="tasks:TaskMixin"/>
    <superKinds itemref="tasks:TaskEventExtraMixin"/>
    <superKinds itemref="calendar:CalendarEventMixin"/>
    <superKinds itemref="mail:MailMessage"/>
  </Kind>

<!-- Project -->


  <Kind itsName="Project">
    <classes key="python">osaf.contentmodel.ContentModel.Project</classes>
    <superKinds itemref="cm:ContentItem"/>
    <displayName>Project</displayName>
    <examples>my "Housewarming Party" project</examples>
    <examples>my department's "Move to new building" project</examples>
    <examples>my company's "Open Seattle Store" project</examples>
    <description>Users can create projects to help organize their work. Users can take content items (like tasks and mail messages) and assign them to different projects.</description>

      <Attribute itsName="parentProject">
        <displayName>Parent Project</displayName>
        <description>Projects can be organized into hierarchies. Each project can have one parent.</description>
        <type itemref="cm:Project"/>
        <inverseAttribute itemref="cm:Project/subProjects"/>
      </Attribute>

      <Attribute itsName="subProjects">
        <displayName>Sub Projects</displayName>
        <description>Projects can be organized into hierarchies. Each project can have many sub-projects.</description>
        <cardinality>list</cardinality>
        <type itemref="cm:Project"/>
        <inverseAttribute itemref="cm:Project/parentProject"/>
      </Attribute>
  </Kind>

<!-- Group -->
  <Kind itsName="Group">
    <displayName>"Playlist"/"Item Collection"</displayName>
    <description>See http://wiki.osafoundation.org/twiki/bin/view/Jungle/CollectionProject</description>
    <issues>We still need to work out some issues about how "playlists"/"item collections" are modeled.</issues>
    <issues>We need to find a name for these things.</issues>
    <superKinds itemref="cm:ContentItem"/>
    <classes key="python">osaf.contentmodel.ContentModel.Group</classes>
  </Kind>


  <!-- ItemCollection -->

  <Kind itsName="ItemCollection">
    <classes key="python">osaf.contentmodel.ItemCollection.ItemCollection</classes>
    <superKinds itemref="cm:ContentItem"/>
    <superKinds itemref="Query"/>

    <displayName>Item Collection</displayName>

    <Attribute itsName="_rule">
      <type itemref="String"/>
      <initialValue type="String"></initialValue>
    </Attribute>

    <Attribute itsName="kindFilter">
      <type itemref="String"/>
      <cardinality>list</cardinality>
      <initialValue/>
    </Attribute>

    <Attribute itsName="ruleIsStale">
      <type itemref="Boolean"/>
      <initialValue type="Boolean" value="True"/>
    </Attribute>

    <Attribute itsName="indexName">
      <type itemref="String"/>
      <initialValue type="String">__adhoc__</initialValue>
    </Attribute>

    <Attribute itsName="renameable">
      <type itemref="Boolean"/>
    </Attribute>

    <Attribute itsName="source">
      <type itemref="cm:ItemCollection"/>
      <inverseAttribute itemref="cm:ItemCollection/destination"/>
      <cardinality>list</cardinality>
      <initialValue />
    </Attribute>
  
    <Attribute itsName="destination">
      <type itemref="cm:ItemCollection"/>
      <cardinality>list</cardinality>
      <inverseAttribute itemref="cm:ItemCollection/source"/>
      <cardinality>list</cardinality>
    </Attribute>


    <Attribute itsName="invitees">
        <description value="The people who are being invited to share in this item; filled in when the user types in the DV's 'invite' box, then cleared on send (entries copied to the share object)." />
        <issues value="Bad that we have just one of these per item collection, though an item collection could have multiple shares post-0.5" />
        <type itemref="mail:EmailAddress" />
        <cardinality value="list" />
        <initialValue />
        <inverseAttribute itemref="mail:EmailAddress/inviteeOf" />
    </Attribute>

    <!-- redirections -->
    <Attribute itsName="about">
      <redirectTo>displayName</redirectTo>
    </Attribute>

    <!-- Default Cloud -->
    <Cloud itsName="DefaultCloud">
      <Endpoint itsName="inclusions">
        <attribute value="inclusions"/>
        <includePolicy value="byCloud"/>
      </Endpoint>
      <endpoints itemref="cm:ItemCollection/DefaultCloud/inclusions"/>
      <Endpoint itsName="exclusions">
        <attribute value="exclusions"/>
        <includePolicy value="byCloud"/>
      </Endpoint>
      <endpoints itemref="cm:ItemCollection/DefaultCloud/exclusions"/>
      <Endpoint itsName="kindFilter">
        <attribute value="kindFilter"/>
        <includePolicy value="byCloud"/>
      </Endpoint>
      <endpoints itemref="cm:ItemCollection/DefaultCloud/kindFilter"/>
      <Endpoint itsName="contentsOwner">
        <attribute value="contentsOwner"/>
        <includePolicy value="byCloud"/>
      </Endpoint>
      <endpoints itemref="cm:ItemCollection/DefaultCloud/contentsOwner"/>
      <Endpoint itsName="invitees">
        <attribute value="invitees"/>
        <includePolicy value="byValue"/>
      </Endpoint>
      <endpoints itemref="cm:ItemCollection/DefaultCloud/invitees"/>
    </Cloud>
    <clouds alias="default" itemref="cm:ItemCollection/DefaultCloud"/>

      <!-- Sharing Cloud -->
      <Cloud itsName="SharingCloud">
        <Endpoint itsName="displayName">
          <attribute value="displayName"/>
          <includePolicy value="none"/>
        </Endpoint>
        <endpoints alias="displayName" itemref="cm:ItemCollection/SharingCloud/displayName"/>
      </Cloud>
      <clouds alias="sharing" itemref="cm:ItemCollection/SharingCloud"/>

  </Kind>

    <Kind itsName="CurrentPointer">
        <Attribute itsName="item">
            <type itemref="cm:ContentItem"/>
            <cardinality>single</cardinality>
            <initialValue itemref="None"/>
            <inverseAttribute itemref="cm:ContentItem/currentItemOf"/>
        </Attribute>
    </Kind>

</Parcel>
