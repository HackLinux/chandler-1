<?xml version="1.0" encoding="iso-8859-1"?>

<!-- $Revision$ -->
<!-- $Date$ -->
<!-- Copyright (c) 2004 Open Source Applications Foundation -->
<!-- License: http://osafoundation.org/Chandler_0.1_license_terms.htm -->

<Parcel describes="//parcels/osaf/contentmodel/tasks"
        itsName="tasks"
        itemClass="osaf.contentmodel.tasks.Task.TaskParcel"
        xmlns="http://osafoundation.org/parcels/core"
        xmlns:content="http://osafoundation.org/parcels/osaf/contentmodel"
        xmlns:mail="http://osafoundation.org/parcels/osaf/contentmodel/mail"
        xmlns:contact="http://osafoundation.org/parcels/osaf/contentmodel/contacts"
        xmlns:cal="http://osafoundation.org/parcels/osaf/contentmodel/calendar"
        xmlns:tasks="http://osafoundation.org/parcels/osaf/contentmodel/tasks">

  <displayName>Task Content Model</displayName>
  <description>Kinds and Attributes related to Task functionality. 
    This schema is still a strawman schema, a starting point.</description>
  <issues>Consider using the common icalendar task attributes (i.e. percentComplete)</issues>
  <version>0.4</version>
  <author>Open Source Applications Foundation</author>


  <!-- Task attributes -->

  <Attribute itsName="requestor">
    <displayName>Requestor</displayName>
    <issues>Type could be Contact, EmailAddress or String</issues>
    <issues>Think about using the icalendar terminology</issues>
    <type itemref="content:ContentItem"/>
    <inverseAttribute itemref="tasks:requestedTasks"/>
  </Attribute>

  <Attribute itsName="requestedTasks">
    <displayName>Requested Tasks</displayName>
    <cardinality>list</cardinality>
    <type itemref="tasks:Task"/>
    <inverseAttribute itemref="tasks:requestor"/>
  </Attribute>

  <Attribute itsName="requestee">
    <displayName>Requestee</displayName>
    <issues>Type could be Contact, EmailAddress or String</issues>
    <issues>Think about using the icalendar terminology</issues>
    <type itemref="content:ContentItem"/>
    <inverseAttribute itemref="tasks:taskRequests"/>
  </Attribute>

  <Attribute itsName="taskRequests">
    <displayName>Task Requests</displayName>
    <description>List of tasks requested for the contact</description>
    <cardinality>list</cardinality>
    <type itemref="cal:CalendarEvent"/>
    <inverseAttribute itemref="tasks:requestee"/>
  </Attribute>

  <Attribute itsName="dependsOn">
    <displayName>Depends On</displayName>
    <cardinality>list</cardinality>
    <type itemref="tasks:Task"/>
    <inverseAttribute itemref="tasks:preventsProgressOn"/>
  </Attribute>

  <Attribute itsName="preventsProgressOn">
    <displayName>Blocks</displayName>
    <cardinality>list</cardinality>
    <type itemref="tasks:Task"/>
    <inverseAttribute itemref="tasks:dependsOn"/>
  </Attribute>

  <Attribute itsName="taskStatus">
    <displayName>Task Status</displayName>
    <type itemref="tasks:TaskStatusEnum"/>
  </Attribute>

  <Enumeration itsName="TaskStatusEnum">
    <displayName>Task Status</displayName>
    <values>todo</values>
    <values>blocked</values>
    <values>done</values>
    <values>deferred</values>
  </Enumeration>

  <Attribute itsName="dueDate">
    <displayName>Due date</displayName>
    <type itemref="DateTime"/>
  </Attribute>

  <Kind itsName="TaskMixin">
    <displayName>Task Mixin Kind</displayName>
    <description>This is the set of Task-specific attributes.</description>
    <description>This Kind is 'mixed in' to others kinds to create Kinds that can be instantiated</description>

    <attributes itemref="cal:recurrence"/>
    <attributes itemref="cal:reminders"/>

    <!-- task-specific attributes -->
    <attributes itemref="tasks:requestor"/>
    <attributes itemref="tasks:requestee"/>
    <attributes itemref="tasks:dependsOn"/>
    <attributes itemref="tasks:preventsProgressOn"/>
    <attributes itemref="tasks:taskStatus"/>
    <attributes itemref="tasks:dueDate"/>
    
    <!-- redirections -->
    <Attribute itsName="who">
      <redirectTo>requestee</redirectTo>
    </Attribute>
  
    <Attribute itsName="whoFrom">
      <redirectTo>requestor</redirectTo>
    </Attribute>
  
    <Attribute itsName="about">
      <redirectTo>displayName</redirectTo>
    </Attribute>
  
    <Attribute itsName="date">
      <redirectTo>dueDate</redirectTo>
    </Attribute>  

    <classes key="python">osaf.contentmodel.tasks.Task.TaskMixin</classes>
      
    <Cloud itsName="Cloud">
      <kind itemref="tasks:TaskMixin"/>
      <Endpoint itsName="requestor">
        <attribute value="requestor"/>
        <includePolicy value="byValue"/>
      </Endpoint>
      <endpoints itemref="tasks:TaskMixin/Cloud/requestor"/>

      <Endpoint itsName="requestee">
        <attribute value="requestee"/>
        <includePolicy value="byValue"/>
      </Endpoint>
      <endpoints itemref="tasks:TaskMixin/Cloud/requestee"/>

      <Endpoint itsName="dependsOn">
        <attribute value="dependsOn"/>
        <includePolicy value="byValue"/>
      </Endpoint>
      <endpoints itemref="tasks:TaskMixin/Cloud/dependsOn"/>

      <Endpoint itsName="preventsProgressOn">
        <attribute value="preventsProgressOn"/>
        <includePolicy value="byValue"/>
      </Endpoint>
      <endpoints itemref="tasks:TaskMixin/Cloud/preventsProgressOn"/>

    </Cloud>
      
  </Kind>

  <Kind itsName="Task">
    <displayName>Task</displayName>
    <issues>Do we want to support the idea of tasks having sub-tasks? If so, then we need to add attributes for 'superTask' and 'subTasks'.</issues>
    <issues>Task should maybe have a 'Timezone' attribute.</issues>
    <superKinds itemref="tasks:TaskMixin"/>
    <superKinds itemref="content:Note"/>
    <classes key="python">osaf.contentmodel.tasks.Task.Task</classes>
    
  </Kind>

</Parcel>
