--- Python-2.3.3/Mac/OSX/Makefile	Tue Nov  4 14:45:16 2003
+++ Python-2.3.3-patched/Mac/OSX/Makefile	Thu Mar 11 00:55:56 2004
@@ -58,8 +58,7 @@
 compileall=$(srcdir)/Lib/compileall.py
 bundlebuilder=$(srcdir)/Lib/plat-mac/bundlebuilder.py
 
-installapps: install_PythonLauncher install_Python install_BuildApplet install_IDE \
-	install_IDLE install_PackageManager
+installapps: install_Python
 
 install_PythonLauncher:
 	cd $(srcdir)/Mac/OSX/PythonLauncher/PythonLauncher.pbproj ; \
--- Python-2.3.3/PC/getpathp.c	Mon Aug 18 10:54:10 2003
+++ Python-2.3.3-patched/PC/getpathp.c	Thu Mar 11 10:45:08 2004
@@ -479,8 +479,14 @@
 	}
  
 	skiphome = pythonhome==NULL ? 0 : 1;
-	machinepath = getpythonregpath(HKEY_LOCAL_MACHINE, skiphome);
-	userpath = getpythonregpath(HKEY_CURRENT_USER, skiphome);
+
+#if 0
+        /* Chandler doesn't want to grab registry info because we want to
+         * ignore extensions that the user already has installed.
+         */
+        machinepath = getpythonregpath(HKEY_LOCAL_MACHINE, skiphome);
+        userpath = getpythonregpath(HKEY_CURRENT_USER, skiphome);
+#endif
 	/* We only use the default relative PYTHONPATH if we havent
 	   anything better to use! */
 	skipdefault = envpath!=NULL || pythonhome!=NULL || \
--- Python-2.3.3/Lib/distutils/sysconfig.py	Mon Feb 10 06:02:33 2003
+++ Python-2.3.3-patched/Lib/distutils/sysconfig.py	Tue Mar 16 14:39:57 2004
@@ -149,6 +149,19 @@
         (cc, cxx, opt, basecflags, ccshared, ldshared, so_ext) = \
             get_config_vars('CC', 'CXX', 'OPT', 'BASECFLAGS', 'CCSHARED', 'LDSHARED', 'SO')
 
+        # Chandler: add the -F flag needed to compile to installed Framework
+        if ldshared.endswith('-framework Python'):
+            site = None
+            for path in sys.path:
+                if path.endswith('site-packages'):
+                    site = path
+                    break
+            if site is not None:
+                pos = site.find('Library/Frameworks')
+                if pos > 0:
+                    ldshared = "%s -F%s -framework Python" %(ldshared[:-18],
+                                                             site[0:pos+18])
+        
         if os.environ.has_key('CC'):
             cc = os.environ['CC']
         if os.environ.has_key('CXX'):
--- Python-2.3.3/setup.py	2003-10-21 13:01:21.000000000 -0700
+++ Python-2.3.3-patched/setup.py	2004-05-10 14:04:44.000000000 -0700
@@ -516,6 +516,13 @@
                                 )},
             }
 
+        # for Chandler build
+        if os.environ.has_key('DB'):
+            DB = os.environ['DB']
+            db_try_this['db4']['libdirs'] = ( os.path.join(DB, 'lib'), )
+            db_try_this['db4']['incdirs'] = ( os.path.join(DB, 'include'), )
+            del db_try_this['db3']
+
         db_search_order = db_try_this.keys()
         db_search_order.sort()
         db_search_order.reverse()
@@ -540,7 +547,7 @@
                     db_incs = find_file('db.h', [], dbd['incdirs'])
                     dblib_dir = find_library_file(self.compiler,
                                                   dblib,
-                                                  lib_dirs,
+                                                  [],
                                                   list(dbd['libdirs']))
                     if (db_incs or dbkey == std_dbinc) and \
                            dblib_dir is not None:
--- Python-2.3.3/Lib/distutils/command/build_ext.py	Tue Nov 19 05:12:28 2002
+++ Python-2.3.3-patched/Lib/distutils/command/build_ext.py	Wed Oct 13 22:27:02 2004
@@ -81,6 +81,10 @@
          "specify the compiler type"),
         ('swig-cpp', None,
          "make SWIG create C++ files (default is C)"),
+        ('swig-opts=', None,
+         "list of SWIG command line options"),
+        ('swig=', None,
+         "path to the SWIG executable"),
         ]
 
     boolean_options = ['inplace', 'debug', 'force', 'swig-cpp']
@@ -108,7 +112,8 @@
         self.force = None
         self.compiler = None
         self.swig_cpp = None
-
+        self.swig_opts = None
+        self.swig = None
 
     def finalize_options (self):
         from distutils import sysconfig
@@ -205,6 +210,11 @@
         if self.undef:
             self.undef = string.split(self.undef, ',')
 
+        if self.swig_opts is None:
+            self.swig_opts = []
+        else:
+            self.swig_opts = self.swig_opts.split(' ')
+
     # finalize_options ()
 
 
@@ -509,7 +519,7 @@
         # source -- but there should be an option to put SWIG output in
         # the temp dir.
 
-        if self.swig_cpp:
+        if self.swig_cpp or '-c++' in self.swig_opts:
             target_ext = '.cpp'
         else:
             target_ext = '.c'
@@ -526,8 +536,9 @@
         if not swig_sources:
             return new_sources
 
-        swig = self.find_swig()
-        swig_cmd = [swig, "-python"]
+        swig = self.swig or self.find_swig()
+        swig_cmd = [swig, '-python']
+        swig_cmd.extend(self.swig_opts)
         if self.swig_cpp:
             swig_cmd.append("-c++")
 
